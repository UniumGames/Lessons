### Скрипты. Программирование с помощью C#

Скриптовый язык — это язык программирования, который применяется для написания сценариев – кратких описаний действий, выполняемых движком Unity. А скрипты — это файлы, которые хранят в себе текст написанный на скриптовом языке.

Unity поддерживает следующие языки программирования: C# (с помощью библиотеки Mono), Javascript. Языки C# и Javascript считаются одними из самых популярных среди программистов. На C# пишутся программы для компьютера, веб приложения. Javascript активно используется для создания интернет страниц.

Скрипты можно писать вручную с помощью языка программирования, либо с помощью сторонних инструментов.

![](http://unity3d.unium.ru/lessons/lesson9/images/compile_code.jpg)

```
Скрипт — это компонент.
```

Программист пишет скрипт на одном из поддерживаемых Unity языков, сохраняет его в виде текстового файла. Далее добавляет его в проект Unity. В этот момент Unity проверяет код, написанный в скрипте и, если в нем нет ошибок, происходит компиляция.

```
Компиляция — это трансляция кода, написанного программистом в машинный код, который понимает компьютер.
```

### Панель консоли

Консоль (`Console`) – это панель в Unity, которая отображает ошибки в коде (отображаются красным значком), предупреждения (отображается желтым значком) и позволяет выводить справочную информацию (белый значок). По умолчанию эта панель отображается в нижней части программы в закладке `Console`. Если эта панель не отображается на экране, то в главном меню выбери `Window` → `Console`.

![](http://unity3d.unium.ru/lessons/lesson9/images/console.jpg)

Сообщения отображаются в виде списка. 
* Чтобы очистить список нажми кнопку `Clear`
* Активированный параметр `Clear On Play` автоматически очищает список при каждом запуске игры
* Параметр `Collapse` объединяет повторяющиеся строки в одну и показывает количество повторений

### Установка среды разработки

Чтобы писать программы, необходим редактор кода. 

В комплекте с Unity идет [MonoDevelop](https://docs.unity3d.com/ru/current/Manual/MonoDevelop.html), так что его не требуется устанавливать отдельно. Вы должны убедиться, что MonoDevelop установлен в качестве внешнего редактора скриптов в `Preferences` (меню: `Edit > Preferences`, а затем выберите панель `External Tools`)

![](https://api.monosnap.com/rpc/file/download?id=4ATOLOPUdGCEFGUr5cjVPQ2biTk77R)

Также MonoDevelop можно обновить с [оффсайта](http://www.monodevelop.com/). Он полностью бесплатен. 

Другой вариант — использовать Visual Studio. [Бесплатная версия](https://www.visualstudio.com/ru/vs/visual-studio-express/) требует регистрации через месяц после установки.

### Создание первого скрипта: вывод сообщения в консоль

Данный код выведет сообщение `Hello world!` в консоль. Функция `Start()` вызовется один раз при старте программы
```csharp
// функция Start() вызывается при инициализации
void Start() {
	print("Hello world!");
}
```

### Комментарии

Код, перед которым стоят два слеша `//`, игнорируется компилятором и ты можешь добавлять туда описание своего кода, чтобы сделать его понятнее

```csharp
// выводим сообщение в консоль
print("текст");
```

### События

Код, который должен вызываться один раз при старте программы, мы пишем внутри функции `Start()` (как в примере выше)

Код, который должен вызываться каждый кадр, мы пишем внутри функции `Update()` 

```csharp
// функция Update() вызывается в каждом кадре
void Update () {
	print("update");
}
```

### Переменные

Если хотим сохранить данные (количество жизней игрока, патронов или очков опыта), то для этого используются переменные. Переменные разделяются на типы, которых существует огромное множество.

Разберем самые популярные:

- `string`. Позволяет хранит текст(пример: имя игрока);
- `int`. Хранит числа как положительные, так и отрицательные (пример: 50, -100);
- `float`. Хранит числа с плавающей точкой одинарной точности (пример: 3.14f);
- `double`. Хранит числа с плавающей точкой двойной точности (пример: 3.14);
- `bool`. Переменная-переключатель. Хранит состояние `включено` (true) или `выключено` (false);
- `Vector2`. Переменная данного типа хранит в себе значение по оси x и y;
- `Vector3`. Переменная данного типа хранит в себе значение по оси x, y и z;
- `GameObject`. Переменная хранит в себе объект из сцены Unity;
- `Transform`. Переменная хранит в себе transform (координаты, поворот и масштаб) объекта из сцены Unity;
- `Color`. Хранит цвет;

Так создается целочисленная переменная с именем `number`, в которую записывается число 42

```csharp
int number = 42;
```

### Операции с переменными

Переменные одного типа можно складывать, вычитать, умножать и делить. 

Разберем их подробнее:

- `+` — операция сложения;
- `-` — операция вычитания;
- `*` — операция умножения;
- `/`— операция деления.

Рассмотрим пример вывода суммы целых чисел в консоль.

```csharp
void Start() {
	int a = 5; // объявляем переменную a
	int b = -3; // объявляем переменную b
	int c = a + b; // складываем a и b, результат сохраняем в c
	print(c); // выводим с в консоль
}
```

Того же результата можно добиться и не сохраняя числа в переменные

```csharp
void Start () {
	print(5 - 3);
}
```

### Конкатенация строк

Часто возникает необходимость соединения нескольких строк и цифр вместе. Для этих целей используется символ `+`, так же как и для сложения чисел  (конкатенация – это совмещение несколько строк в одну). 

Пример

```csharp
void Start () {
	string word1 = "Hello ";
	string word2 = "world";
	string word3 = "!";
	print(word1 + word2 + word3);
}
```

Или без использования переменных

```csharp
void Start () {
	print("Hello " + "world" + "!");
}
```

### Счетчик времени с помощью Time.deltaTime

Практически во всех играх требуется знать сколько времени прошло с момента запуска игры (пример: игры на время). Но в Unity мы можем узнать только сколько прошло времени между кадрами (напоминаю, что игра – это набор кадров, которые быстро меняются. В одну секунду количество таких кадров может достигать 60 и больше). 

Чтобы узнать сколько времени прошло между кадрами — используется `Time.deltaTime`. 

Чтобы сделать дробное число целым, ставим перед ним `(int)`

```csharp
// переменная time может хранить дробные числа
double time = 0;
void Update () {
	// складываем time и Time.deltaTime
	// результат сохраняем обратно в time,
	// чтобы время обновилось
	time = time + Time.deltaTime;
	// отбрасывем дробную часть 
	// и сохраняем целую часть в seconds
	int seconds = (int)time;
	print(seconds);
}
```

### Позиция объекта

Координаты  объекта хранятся в свойстве `transform.position`. Каждая координата имеет тип `float`

```csharp
void Start () {
	// выводим координаты x, y и z
	print(transform.position.x);
	print(transform.position.y);
	print(transform.position.z);
}
```
### Получение внешних объектов и параметров

Часто нам требуется, чтобы один объект взаимодействовал с другим. Для этого в скрипте данного объекта следует создать публичную переменную

```csharp
// создаем переменную, в которой 
// будем хранить ссылку на transform врага
public Transform enemy;
```

После этого она появится в инспекторе свойств объекта. И мы сможем присвоить ей нужное значение (или объект)

![](https://api.monosnap.com/rpc/file/download?id=D60kfPkGu4MV9ijO2Dk4oSV0vfneR9)

В этом примере мы выводим в консоль координаты врага, ссылка на который добавляется через инспектор свойств объекта

```csharp
using UnityEngine;

public class EnemyCoordinates : MonoBehaviour {
	// публичная переменная для хранения врага
	public Transform enemy;

	void Start () {
		print(enemy.position.x);
		print(enemy.position.y);
		print(enemy.position.z);
	}
}
```
